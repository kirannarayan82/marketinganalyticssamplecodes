{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Generating a Random String including letters and digits\n",
      "First Random String is   FhBHIxTA\n"
     ]
    }
   ],
   "source": [
    "#Lets generate sample function to generate customer profile ids and transaction ids\n",
    "import random\n",
    "import string\n",
    "import pandas as pd\n",
    "from datetime import datetime\n",
    "import numpy as np\n",
    "def randomStringDigits(stringLength=6):\n",
    "    \"\"\"Generate a random string of letters and digits \"\"\"\n",
    "    lettersAndDigits = string.ascii_letters + string.digits\n",
    "    return ''.join(random.choice(lettersAndDigits).join(random.choice(lettersAndDigits)) for i in range(stringLength))\n",
    "print (\"Generating a Random String including letters and digits\")\n",
    "print (\"First Random String is  \", randomStringDigits(8))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "# Lets generate some dummy data for customer demography namely geography,age,gender,\n",
    "geocode=['State1','State2','State3','State4']\n",
    "geog=pd.DataFrame([np.random.choice(geocode) for _ in range(50000)])\n",
    "age=pd.DataFrame(np.random.randint(20,48,size=279149))\n",
    "genderid=['Male','Female']\n",
    "gender=pd.DataFrame([np.random.choice(genderid) for _ in range(50000)])\n",
    "lettersAndDigits = string.ascii_letters + string.digits\n",
    "profileid=pd.DataFrame(randomStringDigits(5) for _ in range(50000))\n",
    "demodata=pd.concat([geog,age,gender,profileid],axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>0</th>\n",
       "      <th>0</th>\n",
       "      <th>0</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>State1</td>\n",
       "      <td>39</td>\n",
       "      <td>Female</td>\n",
       "      <td>hbSHb</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>State2</td>\n",
       "      <td>44</td>\n",
       "      <td>Female</td>\n",
       "      <td>V5fLj</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>State1</td>\n",
       "      <td>32</td>\n",
       "      <td>Male</td>\n",
       "      <td>nvRcD</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>State1</td>\n",
       "      <td>27</td>\n",
       "      <td>Male</td>\n",
       "      <td>6coA1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>State4</td>\n",
       "      <td>44</td>\n",
       "      <td>Female</td>\n",
       "      <td>ebcdr</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>State4</td>\n",
       "      <td>25</td>\n",
       "      <td>Male</td>\n",
       "      <td>CeIwa</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>State1</td>\n",
       "      <td>39</td>\n",
       "      <td>Female</td>\n",
       "      <td>VIxuG</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>State1</td>\n",
       "      <td>35</td>\n",
       "      <td>Female</td>\n",
       "      <td>WpHDi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>State2</td>\n",
       "      <td>31</td>\n",
       "      <td>Female</td>\n",
       "      <td>UnTAU</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>State1</td>\n",
       "      <td>22</td>\n",
       "      <td>Female</td>\n",
       "      <td>DIQW8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>State2</td>\n",
       "      <td>47</td>\n",
       "      <td>Male</td>\n",
       "      <td>bsKc5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>State2</td>\n",
       "      <td>39</td>\n",
       "      <td>Female</td>\n",
       "      <td>GY1se</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>State4</td>\n",
       "      <td>45</td>\n",
       "      <td>Male</td>\n",
       "      <td>cFZOR</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>State4</td>\n",
       "      <td>22</td>\n",
       "      <td>Male</td>\n",
       "      <td>Ksr2k</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>State4</td>\n",
       "      <td>32</td>\n",
       "      <td>Female</td>\n",
       "      <td>WinRG</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>State2</td>\n",
       "      <td>43</td>\n",
       "      <td>Female</td>\n",
       "      <td>1AGHL</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>State3</td>\n",
       "      <td>35</td>\n",
       "      <td>Male</td>\n",
       "      <td>G2UNk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>State2</td>\n",
       "      <td>47</td>\n",
       "      <td>Male</td>\n",
       "      <td>7X9vM</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>State1</td>\n",
       "      <td>32</td>\n",
       "      <td>Male</td>\n",
       "      <td>hJTKJ</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>State1</td>\n",
       "      <td>47</td>\n",
       "      <td>Female</td>\n",
       "      <td>XSMgP</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>State4</td>\n",
       "      <td>35</td>\n",
       "      <td>Male</td>\n",
       "      <td>KNbvo</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>State2</td>\n",
       "      <td>47</td>\n",
       "      <td>Female</td>\n",
       "      <td>IQbcj</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>State4</td>\n",
       "      <td>33</td>\n",
       "      <td>Male</td>\n",
       "      <td>n9uJA</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>State1</td>\n",
       "      <td>34</td>\n",
       "      <td>Male</td>\n",
       "      <td>blz0Z</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>State2</td>\n",
       "      <td>35</td>\n",
       "      <td>Male</td>\n",
       "      <td>47YPh</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>State2</td>\n",
       "      <td>32</td>\n",
       "      <td>Male</td>\n",
       "      <td>Folg3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>State2</td>\n",
       "      <td>33</td>\n",
       "      <td>Male</td>\n",
       "      <td>rMC8W</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>State3</td>\n",
       "      <td>20</td>\n",
       "      <td>Male</td>\n",
       "      <td>bP62U</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>State1</td>\n",
       "      <td>21</td>\n",
       "      <td>Male</td>\n",
       "      <td>oHuOC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>State3</td>\n",
       "      <td>34</td>\n",
       "      <td>Female</td>\n",
       "      <td>DK91T</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279119</th>\n",
       "      <td>NaN</td>\n",
       "      <td>38</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279120</th>\n",
       "      <td>NaN</td>\n",
       "      <td>40</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279121</th>\n",
       "      <td>NaN</td>\n",
       "      <td>44</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279122</th>\n",
       "      <td>NaN</td>\n",
       "      <td>38</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279123</th>\n",
       "      <td>NaN</td>\n",
       "      <td>33</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279124</th>\n",
       "      <td>NaN</td>\n",
       "      <td>44</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279125</th>\n",
       "      <td>NaN</td>\n",
       "      <td>30</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279126</th>\n",
       "      <td>NaN</td>\n",
       "      <td>41</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279127</th>\n",
       "      <td>NaN</td>\n",
       "      <td>46</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279128</th>\n",
       "      <td>NaN</td>\n",
       "      <td>43</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279129</th>\n",
       "      <td>NaN</td>\n",
       "      <td>45</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279130</th>\n",
       "      <td>NaN</td>\n",
       "      <td>33</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279131</th>\n",
       "      <td>NaN</td>\n",
       "      <td>24</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279132</th>\n",
       "      <td>NaN</td>\n",
       "      <td>24</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279133</th>\n",
       "      <td>NaN</td>\n",
       "      <td>32</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279134</th>\n",
       "      <td>NaN</td>\n",
       "      <td>45</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279135</th>\n",
       "      <td>NaN</td>\n",
       "      <td>39</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279136</th>\n",
       "      <td>NaN</td>\n",
       "      <td>42</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279137</th>\n",
       "      <td>NaN</td>\n",
       "      <td>24</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279138</th>\n",
       "      <td>NaN</td>\n",
       "      <td>33</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279139</th>\n",
       "      <td>NaN</td>\n",
       "      <td>35</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279140</th>\n",
       "      <td>NaN</td>\n",
       "      <td>31</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279141</th>\n",
       "      <td>NaN</td>\n",
       "      <td>42</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279142</th>\n",
       "      <td>NaN</td>\n",
       "      <td>20</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279143</th>\n",
       "      <td>NaN</td>\n",
       "      <td>45</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279144</th>\n",
       "      <td>NaN</td>\n",
       "      <td>31</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279145</th>\n",
       "      <td>NaN</td>\n",
       "      <td>42</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279146</th>\n",
       "      <td>NaN</td>\n",
       "      <td>26</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279147</th>\n",
       "      <td>NaN</td>\n",
       "      <td>32</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279148</th>\n",
       "      <td>NaN</td>\n",
       "      <td>39</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>279149 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             0   0       0      0\n",
       "0       State1  39  Female  hbSHb\n",
       "1       State2  44  Female  V5fLj\n",
       "2       State1  32    Male  nvRcD\n",
       "3       State1  27    Male  6coA1\n",
       "4       State4  44  Female  ebcdr\n",
       "5       State4  25    Male  CeIwa\n",
       "6       State1  39  Female  VIxuG\n",
       "7       State1  35  Female  WpHDi\n",
       "8       State2  31  Female  UnTAU\n",
       "9       State1  22  Female  DIQW8\n",
       "10      State2  47    Male  bsKc5\n",
       "11      State2  39  Female  GY1se\n",
       "12      State4  45    Male  cFZOR\n",
       "13      State4  22    Male  Ksr2k\n",
       "14      State4  32  Female  WinRG\n",
       "15      State2  43  Female  1AGHL\n",
       "16      State3  35    Male  G2UNk\n",
       "17      State2  47    Male  7X9vM\n",
       "18      State1  32    Male  hJTKJ\n",
       "19      State1  47  Female  XSMgP\n",
       "20      State4  35    Male  KNbvo\n",
       "21      State2  47  Female  IQbcj\n",
       "22      State4  33    Male  n9uJA\n",
       "23      State1  34    Male  blz0Z\n",
       "24      State2  35    Male  47YPh\n",
       "25      State2  32    Male  Folg3\n",
       "26      State2  33    Male  rMC8W\n",
       "27      State3  20    Male  bP62U\n",
       "28      State1  21    Male  oHuOC\n",
       "29      State3  34  Female  DK91T\n",
       "...        ...  ..     ...    ...\n",
       "279119     NaN  38     NaN    NaN\n",
       "279120     NaN  40     NaN    NaN\n",
       "279121     NaN  44     NaN    NaN\n",
       "279122     NaN  38     NaN    NaN\n",
       "279123     NaN  33     NaN    NaN\n",
       "279124     NaN  44     NaN    NaN\n",
       "279125     NaN  30     NaN    NaN\n",
       "279126     NaN  41     NaN    NaN\n",
       "279127     NaN  46     NaN    NaN\n",
       "279128     NaN  43     NaN    NaN\n",
       "279129     NaN  45     NaN    NaN\n",
       "279130     NaN  33     NaN    NaN\n",
       "279131     NaN  24     NaN    NaN\n",
       "279132     NaN  24     NaN    NaN\n",
       "279133     NaN  32     NaN    NaN\n",
       "279134     NaN  45     NaN    NaN\n",
       "279135     NaN  39     NaN    NaN\n",
       "279136     NaN  42     NaN    NaN\n",
       "279137     NaN  24     NaN    NaN\n",
       "279138     NaN  33     NaN    NaN\n",
       "279139     NaN  35     NaN    NaN\n",
       "279140     NaN  31     NaN    NaN\n",
       "279141     NaN  42     NaN    NaN\n",
       "279142     NaN  20     NaN    NaN\n",
       "279143     NaN  45     NaN    NaN\n",
       "279144     NaN  31     NaN    NaN\n",
       "279145     NaN  42     NaN    NaN\n",
       "279146     NaN  26     NaN    NaN\n",
       "279147     NaN  32     NaN    NaN\n",
       "279148     NaN  39     NaN    NaN\n",
       "\n",
       "[279149 rows x 4 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "demodata"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Lets generate sample data fro  bookings\n",
    "airportcode=['ACI','ALJ','EDF','ESF','NYC','EWR','CKY','NJN']\n",
    "source=pd.DataFrame([np.random.choice(airportcode) for _ in range(50000)])\n",
    "destination=pd.DataFrame([np.random.choice(airportcode) for _ in range(50000)])\n",
    "bookingamount=pd.DataFrame(np.random.randint(200,500,size=50000))\n",
    "Invoiceamount=pd.DataFrame(np.random.randint(250,550,size=50000))\n",
    "import random\n",
    "import time\n",
    "from random import randrange\n",
    "import datetime \n",
    "start_timestamp1 = time.mktime(time.strptime('01/06/2017  12:33:00','%d/%m/%Y %H:%M:%S'))\n",
    "end_timestamp1 = time.mktime(time.strptime('01/03/2020 14:33:00','%d/%m/%Y %H:%M:%S'))\n",
    "bookingtime=pd.DataFrame([time.strftime(\"%d/%m/%y %H:%M:%S\",time.localtime(randrange(start_timestamp1,end_timestamp1))) for _ in range(50000)])\n",
    "#Generate sample transactionid\n",
    "transactionid=pd.DataFrame(randomStringDigits(8) for _ in range(50000))\n",
    "bookingdata=pd.concat([source,destination,bookingamount,Invoiceamount,bookingtime,profileid,transactionid],axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>0</th>\n",
       "      <th>0</th>\n",
       "      <th>0</th>\n",
       "      <th>0</th>\n",
       "      <th>0</th>\n",
       "      <th>0</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NYC</td>\n",
       "      <td>CKY</td>\n",
       "      <td>482</td>\n",
       "      <td>327</td>\n",
       "      <td>13/01/18 00:47:28</td>\n",
       "      <td>hbSHb</td>\n",
       "      <td>K1HPRGTQ</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CKY</td>\n",
       "      <td>ALJ</td>\n",
       "      <td>328</td>\n",
       "      <td>425</td>\n",
       "      <td>25/03/19 15:28:39</td>\n",
       "      <td>V5fLj</td>\n",
       "      <td>S2bv2jlY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>EDF</td>\n",
       "      <td>ACI</td>\n",
       "      <td>313</td>\n",
       "      <td>284</td>\n",
       "      <td>11/09/19 04:49:13</td>\n",
       "      <td>nvRcD</td>\n",
       "      <td>YSJEayBZ</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>ALJ</td>\n",
       "      <td>NYC</td>\n",
       "      <td>302</td>\n",
       "      <td>401</td>\n",
       "      <td>21/09/17 02:06:57</td>\n",
       "      <td>6coA1</td>\n",
       "      <td>3mlyI5Bf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NYC</td>\n",
       "      <td>NYC</td>\n",
       "      <td>404</td>\n",
       "      <td>438</td>\n",
       "      <td>30/10/18 12:49:07</td>\n",
       "      <td>ebcdr</td>\n",
       "      <td>FWj6gzGK</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>NYC</td>\n",
       "      <td>ALJ</td>\n",
       "      <td>217</td>\n",
       "      <td>477</td>\n",
       "      <td>20/03/18 00:45:23</td>\n",
       "      <td>CeIwa</td>\n",
       "      <td>RlNLiO0a</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>NYC</td>\n",
       "      <td>EDF</td>\n",
       "      <td>235</td>\n",
       "      <td>306</td>\n",
       "      <td>29/04/18 04:20:05</td>\n",
       "      <td>VIxuG</td>\n",
       "      <td>EpxoWHlm</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>EDF</td>\n",
       "      <td>EWR</td>\n",
       "      <td>237</td>\n",
       "      <td>477</td>\n",
       "      <td>10/08/19 18:59:20</td>\n",
       "      <td>WpHDi</td>\n",
       "      <td>kFkNhxgf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>EWR</td>\n",
       "      <td>EWR</td>\n",
       "      <td>480</td>\n",
       "      <td>253</td>\n",
       "      <td>03/12/17 16:24:06</td>\n",
       "      <td>UnTAU</td>\n",
       "      <td>qNA9KmEf</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>NJN</td>\n",
       "      <td>NYC</td>\n",
       "      <td>281</td>\n",
       "      <td>357</td>\n",
       "      <td>06/11/18 12:44:23</td>\n",
       "      <td>DIQW8</td>\n",
       "      <td>CmPNCtRL</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>NYC</td>\n",
       "      <td>NYC</td>\n",
       "      <td>265</td>\n",
       "      <td>461</td>\n",
       "      <td>02/06/18 20:05:55</td>\n",
       "      <td>bsKc5</td>\n",
       "      <td>nFV9lYjv</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>ALJ</td>\n",
       "      <td>ALJ</td>\n",
       "      <td>247</td>\n",
       "      <td>347</td>\n",
       "      <td>29/01/18 18:51:08</td>\n",
       "      <td>GY1se</td>\n",
       "      <td>pQM9vUnZ</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>CKY</td>\n",
       "      <td>NYC</td>\n",
       "      <td>445</td>\n",
       "      <td>437</td>\n",
       "      <td>20/07/19 21:00:51</td>\n",
       "      <td>cFZOR</td>\n",
       "      <td>dEJcuPFc</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>EDF</td>\n",
       "      <td>ESF</td>\n",
       "      <td>432</td>\n",
       "      <td>388</td>\n",
       "      <td>10/12/19 17:04:39</td>\n",
       "      <td>Ksr2k</td>\n",
       "      <td>9RxTAK4C</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>ALJ</td>\n",
       "      <td>EDF</td>\n",
       "      <td>337</td>\n",
       "      <td>473</td>\n",
       "      <td>23/06/17 21:50:49</td>\n",
       "      <td>WinRG</td>\n",
       "      <td>kjEcW3aB</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>CKY</td>\n",
       "      <td>CKY</td>\n",
       "      <td>262</td>\n",
       "      <td>354</td>\n",
       "      <td>24/07/18 00:13:51</td>\n",
       "      <td>1AGHL</td>\n",
       "      <td>XACXvu93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>CKY</td>\n",
       "      <td>ESF</td>\n",
       "      <td>312</td>\n",
       "      <td>532</td>\n",
       "      <td>23/11/19 11:43:28</td>\n",
       "      <td>G2UNk</td>\n",
       "      <td>ewcpywWs</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>ESF</td>\n",
       "      <td>EWR</td>\n",
       "      <td>301</td>\n",
       "      <td>385</td>\n",
       "      <td>09/11/19 00:48:28</td>\n",
       "      <td>7X9vM</td>\n",
       "      <td>kxgL2N4h</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>ALJ</td>\n",
       "      <td>NYC</td>\n",
       "      <td>244</td>\n",
       "      <td>381</td>\n",
       "      <td>22/08/19 21:50:14</td>\n",
       "      <td>hJTKJ</td>\n",
       "      <td>AV3fegNF</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>ESF</td>\n",
       "      <td>CKY</td>\n",
       "      <td>337</td>\n",
       "      <td>418</td>\n",
       "      <td>06/02/20 02:15:47</td>\n",
       "      <td>XSMgP</td>\n",
       "      <td>rv6KoAQP</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>ALJ</td>\n",
       "      <td>NJN</td>\n",
       "      <td>330</td>\n",
       "      <td>357</td>\n",
       "      <td>09/02/20 15:28:28</td>\n",
       "      <td>KNbvo</td>\n",
       "      <td>iXDQjvc1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>EWR</td>\n",
       "      <td>EWR</td>\n",
       "      <td>338</td>\n",
       "      <td>290</td>\n",
       "      <td>16/09/17 01:17:15</td>\n",
       "      <td>IQbcj</td>\n",
       "      <td>2ac9sXtj</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>EDF</td>\n",
       "      <td>ACI</td>\n",
       "      <td>459</td>\n",
       "      <td>303</td>\n",
       "      <td>15/07/19 15:38:05</td>\n",
       "      <td>n9uJA</td>\n",
       "      <td>vvi9XV0f</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>EDF</td>\n",
       "      <td>ACI</td>\n",
       "      <td>438</td>\n",
       "      <td>359</td>\n",
       "      <td>30/01/18 07:45:02</td>\n",
       "      <td>blz0Z</td>\n",
       "      <td>ticuCq4v</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>EDF</td>\n",
       "      <td>NJN</td>\n",
       "      <td>378</td>\n",
       "      <td>522</td>\n",
       "      <td>06/02/20 16:26:55</td>\n",
       "      <td>47YPh</td>\n",
       "      <td>8JaV13Jm</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>EWR</td>\n",
       "      <td>CKY</td>\n",
       "      <td>441</td>\n",
       "      <td>482</td>\n",
       "      <td>31/12/19 03:19:06</td>\n",
       "      <td>Folg3</td>\n",
       "      <td>Eujk6gG7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>ALJ</td>\n",
       "      <td>ALJ</td>\n",
       "      <td>444</td>\n",
       "      <td>469</td>\n",
       "      <td>10/10/18 18:40:58</td>\n",
       "      <td>rMC8W</td>\n",
       "      <td>z6hxERuL</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>CKY</td>\n",
       "      <td>NYC</td>\n",
       "      <td>283</td>\n",
       "      <td>418</td>\n",
       "      <td>24/05/19 17:41:48</td>\n",
       "      <td>bP62U</td>\n",
       "      <td>VqC27KBh</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>EDF</td>\n",
       "      <td>ALJ</td>\n",
       "      <td>283</td>\n",
       "      <td>384</td>\n",
       "      <td>07/11/18 11:08:39</td>\n",
       "      <td>oHuOC</td>\n",
       "      <td>GBCaMxex</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>ALJ</td>\n",
       "      <td>EDF</td>\n",
       "      <td>329</td>\n",
       "      <td>500</td>\n",
       "      <td>30/01/18 11:48:53</td>\n",
       "      <td>DK91T</td>\n",
       "      <td>7ASfHHje</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49970</th>\n",
       "      <td>EDF</td>\n",
       "      <td>EWR</td>\n",
       "      <td>372</td>\n",
       "      <td>424</td>\n",
       "      <td>28/07/17 06:21:07</td>\n",
       "      <td>jvXpK</td>\n",
       "      <td>Sa1ANUC4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49971</th>\n",
       "      <td>ALJ</td>\n",
       "      <td>EDF</td>\n",
       "      <td>250</td>\n",
       "      <td>266</td>\n",
       "      <td>20/11/18 10:17:57</td>\n",
       "      <td>YR4ZH</td>\n",
       "      <td>VtszZa1w</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49972</th>\n",
       "      <td>NJN</td>\n",
       "      <td>NJN</td>\n",
       "      <td>455</td>\n",
       "      <td>429</td>\n",
       "      <td>13/01/20 02:02:53</td>\n",
       "      <td>NOdNP</td>\n",
       "      <td>Gl3FedGu</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49973</th>\n",
       "      <td>NJN</td>\n",
       "      <td>ALJ</td>\n",
       "      <td>462</td>\n",
       "      <td>459</td>\n",
       "      <td>17/01/20 20:00:23</td>\n",
       "      <td>Klwkd</td>\n",
       "      <td>w8lyvFvj</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49974</th>\n",
       "      <td>NYC</td>\n",
       "      <td>ALJ</td>\n",
       "      <td>203</td>\n",
       "      <td>293</td>\n",
       "      <td>28/09/17 07:10:36</td>\n",
       "      <td>I3j8j</td>\n",
       "      <td>Kmf7O6Ic</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49975</th>\n",
       "      <td>ACI</td>\n",
       "      <td>EDF</td>\n",
       "      <td>497</td>\n",
       "      <td>378</td>\n",
       "      <td>24/07/17 03:03:03</td>\n",
       "      <td>LCWQU</td>\n",
       "      <td>zcg5NAwI</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49976</th>\n",
       "      <td>EWR</td>\n",
       "      <td>CKY</td>\n",
       "      <td>250</td>\n",
       "      <td>333</td>\n",
       "      <td>23/01/20 17:36:24</td>\n",
       "      <td>KApJB</td>\n",
       "      <td>YhKjsE84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49977</th>\n",
       "      <td>ALJ</td>\n",
       "      <td>ACI</td>\n",
       "      <td>326</td>\n",
       "      <td>436</td>\n",
       "      <td>20/09/18 16:20:55</td>\n",
       "      <td>LDiU9</td>\n",
       "      <td>GFY1bAnQ</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49978</th>\n",
       "      <td>CKY</td>\n",
       "      <td>NYC</td>\n",
       "      <td>266</td>\n",
       "      <td>437</td>\n",
       "      <td>28/06/18 05:10:44</td>\n",
       "      <td>qBIQR</td>\n",
       "      <td>zVECO54B</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49979</th>\n",
       "      <td>NYC</td>\n",
       "      <td>ALJ</td>\n",
       "      <td>357</td>\n",
       "      <td>273</td>\n",
       "      <td>01/10/18 10:29:00</td>\n",
       "      <td>8lNI5</td>\n",
       "      <td>sIWrdPlP</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49980</th>\n",
       "      <td>CKY</td>\n",
       "      <td>EWR</td>\n",
       "      <td>221</td>\n",
       "      <td>447</td>\n",
       "      <td>28/09/19 06:49:17</td>\n",
       "      <td>3NkRY</td>\n",
       "      <td>7SNBgL3M</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49981</th>\n",
       "      <td>EWR</td>\n",
       "      <td>EWR</td>\n",
       "      <td>345</td>\n",
       "      <td>339</td>\n",
       "      <td>14/12/18 02:14:45</td>\n",
       "      <td>ZkcSu</td>\n",
       "      <td>ChxXjc4C</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49982</th>\n",
       "      <td>NYC</td>\n",
       "      <td>ALJ</td>\n",
       "      <td>269</td>\n",
       "      <td>311</td>\n",
       "      <td>29/11/19 00:47:43</td>\n",
       "      <td>kU01l</td>\n",
       "      <td>uchBinQ2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49983</th>\n",
       "      <td>EDF</td>\n",
       "      <td>ALJ</td>\n",
       "      <td>362</td>\n",
       "      <td>400</td>\n",
       "      <td>24/11/19 01:46:12</td>\n",
       "      <td>otjkC</td>\n",
       "      <td>xUebFW9b</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49984</th>\n",
       "      <td>ESF</td>\n",
       "      <td>ACI</td>\n",
       "      <td>452</td>\n",
       "      <td>513</td>\n",
       "      <td>27/12/19 07:51:08</td>\n",
       "      <td>XrMRE</td>\n",
       "      <td>76US1MDi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49985</th>\n",
       "      <td>EWR</td>\n",
       "      <td>ALJ</td>\n",
       "      <td>364</td>\n",
       "      <td>469</td>\n",
       "      <td>14/06/18 18:58:49</td>\n",
       "      <td>U3Ukh</td>\n",
       "      <td>kIFNAQid</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49986</th>\n",
       "      <td>EDF</td>\n",
       "      <td>NYC</td>\n",
       "      <td>380</td>\n",
       "      <td>251</td>\n",
       "      <td>12/12/17 02:15:20</td>\n",
       "      <td>oCPvs</td>\n",
       "      <td>h6LJOVEj</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49987</th>\n",
       "      <td>NYC</td>\n",
       "      <td>ALJ</td>\n",
       "      <td>465</td>\n",
       "      <td>493</td>\n",
       "      <td>15/11/18 02:19:57</td>\n",
       "      <td>ejg2l</td>\n",
       "      <td>wF1VRBiy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49988</th>\n",
       "      <td>ALJ</td>\n",
       "      <td>CKY</td>\n",
       "      <td>352</td>\n",
       "      <td>426</td>\n",
       "      <td>23/01/18 12:58:15</td>\n",
       "      <td>gfwd0</td>\n",
       "      <td>4L5Bx6gp</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49989</th>\n",
       "      <td>NJN</td>\n",
       "      <td>CKY</td>\n",
       "      <td>340</td>\n",
       "      <td>471</td>\n",
       "      <td>27/06/17 17:19:57</td>\n",
       "      <td>Z4CHQ</td>\n",
       "      <td>MHJMpBFq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49990</th>\n",
       "      <td>ALJ</td>\n",
       "      <td>ALJ</td>\n",
       "      <td>328</td>\n",
       "      <td>475</td>\n",
       "      <td>19/02/20 04:47:45</td>\n",
       "      <td>CDGx0</td>\n",
       "      <td>lT0gK5p6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49991</th>\n",
       "      <td>NJN</td>\n",
       "      <td>NJN</td>\n",
       "      <td>363</td>\n",
       "      <td>308</td>\n",
       "      <td>10/12/19 22:52:51</td>\n",
       "      <td>mf9jH</td>\n",
       "      <td>rynthoQL</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49992</th>\n",
       "      <td>NJN</td>\n",
       "      <td>EDF</td>\n",
       "      <td>209</td>\n",
       "      <td>338</td>\n",
       "      <td>27/09/19 16:45:49</td>\n",
       "      <td>Xzk42</td>\n",
       "      <td>5qV14hgo</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49993</th>\n",
       "      <td>EDF</td>\n",
       "      <td>CKY</td>\n",
       "      <td>255</td>\n",
       "      <td>356</td>\n",
       "      <td>09/11/18 14:30:47</td>\n",
       "      <td>Rg8zC</td>\n",
       "      <td>gdmR0TEu</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49994</th>\n",
       "      <td>NYC</td>\n",
       "      <td>EDF</td>\n",
       "      <td>273</td>\n",
       "      <td>401</td>\n",
       "      <td>26/01/20 14:13:45</td>\n",
       "      <td>5PZT9</td>\n",
       "      <td>uh80PoVt</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49995</th>\n",
       "      <td>NYC</td>\n",
       "      <td>ALJ</td>\n",
       "      <td>264</td>\n",
       "      <td>479</td>\n",
       "      <td>30/12/18 13:29:44</td>\n",
       "      <td>q3Cym</td>\n",
       "      <td>pvL0tcZV</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49996</th>\n",
       "      <td>EDF</td>\n",
       "      <td>EDF</td>\n",
       "      <td>213</td>\n",
       "      <td>286</td>\n",
       "      <td>01/02/18 11:56:31</td>\n",
       "      <td>aF6hU</td>\n",
       "      <td>FuVonmbZ</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49997</th>\n",
       "      <td>NYC</td>\n",
       "      <td>EDF</td>\n",
       "      <td>326</td>\n",
       "      <td>534</td>\n",
       "      <td>28/07/17 22:02:20</td>\n",
       "      <td>5II4A</td>\n",
       "      <td>hkKvHjRQ</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49998</th>\n",
       "      <td>ESF</td>\n",
       "      <td>EDF</td>\n",
       "      <td>317</td>\n",
       "      <td>275</td>\n",
       "      <td>17/01/19 10:20:48</td>\n",
       "      <td>oUfZi</td>\n",
       "      <td>D1jxe7W6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49999</th>\n",
       "      <td>EDF</td>\n",
       "      <td>ESF</td>\n",
       "      <td>226</td>\n",
       "      <td>342</td>\n",
       "      <td>03/06/17 17:37:16</td>\n",
       "      <td>LhDL1</td>\n",
       "      <td>0ZsTneqQ</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>50000 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         0    0    0    0                  0      0         0\n",
       "0      NYC  CKY  482  327  13/01/18 00:47:28  hbSHb  K1HPRGTQ\n",
       "1      CKY  ALJ  328  425  25/03/19 15:28:39  V5fLj  S2bv2jlY\n",
       "2      EDF  ACI  313  284  11/09/19 04:49:13  nvRcD  YSJEayBZ\n",
       "3      ALJ  NYC  302  401  21/09/17 02:06:57  6coA1  3mlyI5Bf\n",
       "4      NYC  NYC  404  438  30/10/18 12:49:07  ebcdr  FWj6gzGK\n",
       "5      NYC  ALJ  217  477  20/03/18 00:45:23  CeIwa  RlNLiO0a\n",
       "6      NYC  EDF  235  306  29/04/18 04:20:05  VIxuG  EpxoWHlm\n",
       "7      EDF  EWR  237  477  10/08/19 18:59:20  WpHDi  kFkNhxgf\n",
       "8      EWR  EWR  480  253  03/12/17 16:24:06  UnTAU  qNA9KmEf\n",
       "9      NJN  NYC  281  357  06/11/18 12:44:23  DIQW8  CmPNCtRL\n",
       "10     NYC  NYC  265  461  02/06/18 20:05:55  bsKc5  nFV9lYjv\n",
       "11     ALJ  ALJ  247  347  29/01/18 18:51:08  GY1se  pQM9vUnZ\n",
       "12     CKY  NYC  445  437  20/07/19 21:00:51  cFZOR  dEJcuPFc\n",
       "13     EDF  ESF  432  388  10/12/19 17:04:39  Ksr2k  9RxTAK4C\n",
       "14     ALJ  EDF  337  473  23/06/17 21:50:49  WinRG  kjEcW3aB\n",
       "15     CKY  CKY  262  354  24/07/18 00:13:51  1AGHL  XACXvu93\n",
       "16     CKY  ESF  312  532  23/11/19 11:43:28  G2UNk  ewcpywWs\n",
       "17     ESF  EWR  301  385  09/11/19 00:48:28  7X9vM  kxgL2N4h\n",
       "18     ALJ  NYC  244  381  22/08/19 21:50:14  hJTKJ  AV3fegNF\n",
       "19     ESF  CKY  337  418  06/02/20 02:15:47  XSMgP  rv6KoAQP\n",
       "20     ALJ  NJN  330  357  09/02/20 15:28:28  KNbvo  iXDQjvc1\n",
       "21     EWR  EWR  338  290  16/09/17 01:17:15  IQbcj  2ac9sXtj\n",
       "22     EDF  ACI  459  303  15/07/19 15:38:05  n9uJA  vvi9XV0f\n",
       "23     EDF  ACI  438  359  30/01/18 07:45:02  blz0Z  ticuCq4v\n",
       "24     EDF  NJN  378  522  06/02/20 16:26:55  47YPh  8JaV13Jm\n",
       "25     EWR  CKY  441  482  31/12/19 03:19:06  Folg3  Eujk6gG7\n",
       "26     ALJ  ALJ  444  469  10/10/18 18:40:58  rMC8W  z6hxERuL\n",
       "27     CKY  NYC  283  418  24/05/19 17:41:48  bP62U  VqC27KBh\n",
       "28     EDF  ALJ  283  384  07/11/18 11:08:39  oHuOC  GBCaMxex\n",
       "29     ALJ  EDF  329  500  30/01/18 11:48:53  DK91T  7ASfHHje\n",
       "...    ...  ...  ...  ...                ...    ...       ...\n",
       "49970  EDF  EWR  372  424  28/07/17 06:21:07  jvXpK  Sa1ANUC4\n",
       "49971  ALJ  EDF  250  266  20/11/18 10:17:57  YR4ZH  VtszZa1w\n",
       "49972  NJN  NJN  455  429  13/01/20 02:02:53  NOdNP  Gl3FedGu\n",
       "49973  NJN  ALJ  462  459  17/01/20 20:00:23  Klwkd  w8lyvFvj\n",
       "49974  NYC  ALJ  203  293  28/09/17 07:10:36  I3j8j  Kmf7O6Ic\n",
       "49975  ACI  EDF  497  378  24/07/17 03:03:03  LCWQU  zcg5NAwI\n",
       "49976  EWR  CKY  250  333  23/01/20 17:36:24  KApJB  YhKjsE84\n",
       "49977  ALJ  ACI  326  436  20/09/18 16:20:55  LDiU9  GFY1bAnQ\n",
       "49978  CKY  NYC  266  437  28/06/18 05:10:44  qBIQR  zVECO54B\n",
       "49979  NYC  ALJ  357  273  01/10/18 10:29:00  8lNI5  sIWrdPlP\n",
       "49980  CKY  EWR  221  447  28/09/19 06:49:17  3NkRY  7SNBgL3M\n",
       "49981  EWR  EWR  345  339  14/12/18 02:14:45  ZkcSu  ChxXjc4C\n",
       "49982  NYC  ALJ  269  311  29/11/19 00:47:43  kU01l  uchBinQ2\n",
       "49983  EDF  ALJ  362  400  24/11/19 01:46:12  otjkC  xUebFW9b\n",
       "49984  ESF  ACI  452  513  27/12/19 07:51:08  XrMRE  76US1MDi\n",
       "49985  EWR  ALJ  364  469  14/06/18 18:58:49  U3Ukh  kIFNAQid\n",
       "49986  EDF  NYC  380  251  12/12/17 02:15:20  oCPvs  h6LJOVEj\n",
       "49987  NYC  ALJ  465  493  15/11/18 02:19:57  ejg2l  wF1VRBiy\n",
       "49988  ALJ  CKY  352  426  23/01/18 12:58:15  gfwd0  4L5Bx6gp\n",
       "49989  NJN  CKY  340  471  27/06/17 17:19:57  Z4CHQ  MHJMpBFq\n",
       "49990  ALJ  ALJ  328  475  19/02/20 04:47:45  CDGx0  lT0gK5p6\n",
       "49991  NJN  NJN  363  308  10/12/19 22:52:51  mf9jH  rynthoQL\n",
       "49992  NJN  EDF  209  338  27/09/19 16:45:49  Xzk42  5qV14hgo\n",
       "49993  EDF  CKY  255  356  09/11/18 14:30:47  Rg8zC  gdmR0TEu\n",
       "49994  NYC  EDF  273  401  26/01/20 14:13:45  5PZT9  uh80PoVt\n",
       "49995  NYC  ALJ  264  479  30/12/18 13:29:44  q3Cym  pvL0tcZV\n",
       "49996  EDF  EDF  213  286  01/02/18 11:56:31  aF6hU  FuVonmbZ\n",
       "49997  NYC  EDF  326  534  28/07/17 22:02:20  5II4A  hkKvHjRQ\n",
       "49998  ESF  EDF  317  275  17/01/19 10:20:48  oUfZi  D1jxe7W6\n",
       "49999  EDF  ESF  226  342  03/06/17 17:37:16  LhDL1  0ZsTneqQ\n",
       "\n",
       "[50000 rows x 7 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "bookingdata"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "bookingdata.columns=['source','destination','bookingamount','Invoiceamount','bookingtime','profileid','transactionid']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Generate sample transactionid\n",
    "transactionid=pd.DataFrame(randomStringDigits(8) for _ in range(50000))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              0\n",
      "0      o71rb7iP\n",
      "1      HhQbivdJ\n",
      "2      2BWOjpp7\n",
      "3      MunqjO0O\n",
      "4      XCjArtBy\n",
      "5      KEyia5B0\n",
      "6      0ad3EEsJ\n",
      "7      yNnPQwhV\n",
      "8      XTNDaGox\n",
      "9      dYB0p4PL\n",
      "10     s9tYCche\n",
      "11     DsEYr2KE\n",
      "12     VS7rT52x\n",
      "13     Guzn9SbV\n",
      "14     mQpXjy61\n",
      "15     qg7YT9Kx\n",
      "16     73NigSoG\n",
      "17     Zjz3yLGM\n",
      "18     ftLjZWOD\n",
      "19     QtNe6AfJ\n",
      "20     uwxltCsg\n",
      "21     IMeYigbo\n",
      "22     BujBEtdH\n",
      "23     tBzS2Rk3\n",
      "24     Q3RIgq0a\n",
      "25     KOoXzjYp\n",
      "26     xedEdpTW\n",
      "27     Uz4t4oAL\n",
      "28     luhbOISf\n",
      "29     V3Q0KAIL\n",
      "...         ...\n",
      "49970  JvqsNuTX\n",
      "49971  Qtk7R0Yb\n",
      "49972  ARNDXO2Z\n",
      "49973  JAsCXtdC\n",
      "49974  HyTARgRI\n",
      "49975  XB2gvpFL\n",
      "49976  0zPXDZey\n",
      "49977  iRJHIvJk\n",
      "49978  CIhPbDG2\n",
      "49979  M0xMxA0Y\n",
      "49980  Sw2AY7cM\n",
      "49981  CWaemvE8\n",
      "49982  R1ipkDN6\n",
      "49983  gwoF6Ckf\n",
      "49984  EynxHkZI\n",
      "49985  uuwMf7Wb\n",
      "49986  073sZY5d\n",
      "49987  KtOmHRVr\n",
      "49988  sklaUaG3\n",
      "49989  2L8r7AhG\n",
      "49990  lk4XVEPr\n",
      "49991  8aVtnWgi\n",
      "49992  ZcqFNMeD\n",
      "49993  uH8oL5CG\n",
      "49994  vs25UFZz\n",
      "49995  5JDzyLwR\n",
      "49996  cBZspqrM\n",
      "49997  ZnL8XHLz\n",
      "49998  TfLyeynt\n",
      "49999  ZRJCOSD4\n",
      "\n",
      "[50000 rows x 1 columns]\n"
     ]
    }
   ],
   "source": [
    "print(transactionid)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Generate sample data for frequent flier and put it fflier dataframe\n",
    "Balance=pd.DataFrame(np.random.randint(200,500,size=50000))\n",
    "Bonusmiles=pd.DataFrame(np.random.randint(200,300,size=50000))    \n",
    "QualMiles=pd.DataFrame(np.random.randint(200,300,size=50000))    \n",
    "BonusTrans=pd.DataFrame(np.random.randint(250,550,size=50000)) \n",
    "FlightMiles=pd.DataFrame(np.random.randint(250,550,size=50000))      \n",
    "QualMiles=pd.DataFrame(np.random.randint(1000,2000,size=50000))     \n",
    "DaysSinceEnroll=pd.DataFrame(np.random.randint(1000,2000,size=50000))     \n",
    "fflier=pd.concat([Balance,BonusTrans,QualMiles,Bonusmiles,FlightMiles,QualMiles,DaysSinceEnroll,profileid],axis=1)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Balance = number of miles eligible for award travel QualMiles = number of miles qualifying for TopFlight status BonusMiles = number of miles earned from non-flight bonus transactions in the past 12 months BonusTrans = number of non-flight bonus transactions in the past 12 months FlightMiles = number of flight miles in the past 12 months FlightTrans = number of flight transactions in the past 12 months DaysSinceEnroll = number of days since enrolled in the frequent flyer program"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "demodata.columns=(['geog','age','gender','profileid'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "fflier.columns=['Balance','Bonusmiles','BonusTrans','QualMiles','FlightMiles','QualMiles','DaysSinceEnroll','profileid']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "import datetime\n",
    "now = (datetime.datetime.now())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "bookingdata['dayssincelasttransaction']=now-pd.to_datetime(bookingdata.bookingtime)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "bookingdata['dayssincelasttransaction']=bookingdata['dayssincelasttransaction'].dt.days"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "bookingdata['target']=np.where(bookingdata['dayssincelasttransaction']>365,1,0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1    49099\n",
       "0      901\n",
       "Name: target, dtype: int64"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "bookingdata.target.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['source', 'destination', 'bookingamount', 'Invoiceamount',\n",
       "       'bookingtime', 'profileid', 'transactionid', 'dayssincelasttransaction',\n",
       "       'target'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "bookingdata.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['geog', 'age', 'gender', 'profileid'], dtype='object')"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "demodata.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "profileid=pd.DataFrame(randomStringDigits(5) for _ in range(50000))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "bookingdata['profileid']=profileid"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "#merging bookings data ,fflier data, and profile data\n",
    "mergeddata=pd.merge(bookingdata,demodata,on=\"profileid\")\n",
    "mergeddata=pd.merge(mergeddata,fflier,on=\"profileid\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>source</th>\n",
       "      <th>destination</th>\n",
       "      <th>bookingamount</th>\n",
       "      <th>Invoiceamount</th>\n",
       "      <th>bookingtime</th>\n",
       "      <th>profileid</th>\n",
       "      <th>transactionid</th>\n",
       "      <th>dayssincelasttransaction</th>\n",
       "      <th>target</th>\n",
       "      <th>geog</th>\n",
       "      <th>age</th>\n",
       "      <th>gender</th>\n",
       "      <th>Balance</th>\n",
       "      <th>Bonusmiles</th>\n",
       "      <th>BonusTrans</th>\n",
       "      <th>QualMiles</th>\n",
       "      <th>FlightMiles</th>\n",
       "      <th>QualMiles</th>\n",
       "      <th>DaysSinceEnroll</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EDF</td>\n",
       "      <td>ESF</td>\n",
       "      <td>471</td>\n",
       "      <td>288</td>\n",
       "      <td>08/12/17 23:35:41</td>\n",
       "      <td>ZnuXu</td>\n",
       "      <td>Ao1a4doe</td>\n",
       "      <td>1302</td>\n",
       "      <td>1</td>\n",
       "      <td>State1</td>\n",
       "      <td>35</td>\n",
       "      <td>Female</td>\n",
       "      <td>440</td>\n",
       "      <td>345</td>\n",
       "      <td>1137</td>\n",
       "      <td>203</td>\n",
       "      <td>335</td>\n",
       "      <td>1137</td>\n",
       "      <td>1103</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NJN</td>\n",
       "      <td>ESF</td>\n",
       "      <td>274</td>\n",
       "      <td>460</td>\n",
       "      <td>20/02/19 16:48:26</td>\n",
       "      <td>hZX5a</td>\n",
       "      <td>v53543SN</td>\n",
       "      <td>746</td>\n",
       "      <td>1</td>\n",
       "      <td>State1</td>\n",
       "      <td>34</td>\n",
       "      <td>Female</td>\n",
       "      <td>349</td>\n",
       "      <td>294</td>\n",
       "      <td>1424</td>\n",
       "      <td>253</td>\n",
       "      <td>351</td>\n",
       "      <td>1424</td>\n",
       "      <td>1604</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  source destination  bookingamount  Invoiceamount        bookingtime  \\\n",
       "0    EDF         ESF            471            288  08/12/17 23:35:41   \n",
       "1    NJN         ESF            274            460  20/02/19 16:48:26   \n",
       "\n",
       "  profileid transactionid  dayssincelasttransaction  target    geog  age  \\\n",
       "0     ZnuXu      Ao1a4doe                      1302       1  State1   35   \n",
       "1     hZX5a      v53543SN                       746       1  State1   34   \n",
       "\n",
       "   gender  Balance  Bonusmiles  BonusTrans  QualMiles  FlightMiles  QualMiles  \\\n",
       "0  Female      440         345        1137        203          335       1137   \n",
       "1  Female      349         294        1424        253          351       1424   \n",
       "\n",
       "   DaysSinceEnroll  \n",
       "0             1103  \n",
       "1             1604  "
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mergeddata"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['source', 'destination', 'bookingamount', 'Invoiceamount',\n",
       "       'bookingtime', 'profileid', 'transactionid', 'dayssincelasttransaction',\n",
       "       'target', 'geog', 'age', 'gender', 'Balance', 'Bonusmiles',\n",
       "       'BonusTrans', 'QualMiles', 'FlightMiles', 'QualMiles',\n",
       "       'DaysSinceEnroll'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mergeddata.columns\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "mergeddata.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.axes._subplots.AxesSubplot at 0x7f9cd9256610>"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#EDA\n",
    "#Exploratory Data Analysis to understand the overall picture of Churn\n",
    "import seaborn as sns\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "gender_plot = mergeddata.groupby(['target', 'gender']).size().reset_index().pivot(columns='gender', index='target',values=0) \n",
    "geo_plot = mergeddata.groupby(['target', 'geog']).size().reset_index().pivot(columns='geog', index='target',values=0) \n",
    "#sales_plot = mergeddata.groupby(['target','geog']).size().reset_index().pivot(columns='bookingamount', index='target', values=0) \n",
    "fig, axarr = plt.subplots(2, 3, figsize=(20,20))\n",
    "sns.boxplot(x=mergeddata.target,y=mergeddata.bookingamount,ax=axarr[0][0])\n",
    "sns.boxplot(x=mergeddata.target,y=mergeddata.bookingamount,ax=axarr[0][0])\n",
    "geo_plot.plot(kind='bar',stacked=\"True\",ax=axarr[0][1])\n",
    "gender_plot.plot(kind='bar', stacked=\"True\",ax=axarr[0][2])\n",
    "sns.boxplot(x=mergeddata.target,y=mergeddata.age,ax=axarr[1][0])\n",
    "sns.boxplot(x=mergeddata.target,y=mergeddata.gender,ax=axarr[1][1])\n",
    "sns.boxplot(x=mergeddata.target,y=mergeddata.Balance,ax=axarr[1][2])\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.axes._subplots.AxesSubplot at 0x7f9cd8154a10>"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.boxplot(x=mergeddata.target,y=mergeddata.Invoiceamount)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    345\n",
       "1    294\n",
       "Name: Bonusmiles, dtype: int64"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mergeddata['Bonusmiles']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [],
   "source": [
    "counts=mergeddata.gender.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Female    2\n",
       "Name: gender, dtype: int64"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "counts"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.axes._subplots.AxesSubplot at 0x7f9cd79d5ad0>"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 1440x1440 with 6 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig, axarr = plt.subplots(2, 3, figsize=(20,20))\n",
    "sns.boxplot(x=mergeddata.target,y=mergeddata.Invoiceamount,ax=axarr[0][1])\n",
    "sns.boxplot(x=mergeddata.target,y=mergeddata.age,ax=axarr[0][0])\n",
    "sns.boxplot(x=mergeddata.target,y=mergeddata.gender,ax=axarr[0][2])\n",
    "sns.boxplot(x=mergeddata.target,y=mergeddata.Balance,ax=axarr[1][0])\n",
    "sns.boxplot(x=mergeddata.target,y=mergeddata.Bonusmiles,ax=axarr[1][1])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "mergeddata.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "!pip install imblearn"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Function to plot ROC curves for the different machine learning algorithms we will attempt\n",
    "def plotroc(fpr,tpr):\n",
    "    import matplotlib.pyplot as plt\n",
    "    from sklearn.metrics import classification_report\n",
    "    from sklearn.metrics import roc_auc_score\n",
    "    from sklearn.metrics import roc_curve\n",
    "    from sklearn import metrics\n",
    "    plt.figure(figsize=(10,10))\n",
    "    plt.title('Receiver Operating Characteristic')\n",
    "    plt.plot(fpr,tpr, color='red',label = 'AUC = %0.2f')# roc_auc)\n",
    "    plt.legend(loc = 'lower right')\n",
    "    plt.plot([0, 1], [0, 1],linestyle='--')\n",
    "    plt.axis('tight')\n",
    "    plt.ylabel('True Positive Rate')\n",
    "    plt.xlabel('False Positive Rate')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [],
   "source": [
    "#We will define a function to build machine learning algorithms to generate churn probabilites.\n",
    "def buildmodel(dataframe):\n",
    "    modeldict={}\n",
    "    productdata=dataframe\n",
    "    productdata\n",
    "    numericfeatures=productdata[['Bookingamount','Invoiceamount','dayssincelasttransaction','BonusTrans', 'QualMiles', 'Bonusmiles', 'FlightMiles','age','DaysSinceEnroll'] ]\n",
    "    catfeatures=productdata[['geog','gender']]\n",
    "    model_target=productdata[\"target\"].values\n",
    "    catfeatures=pd.get_dummies(catfeatures)\n",
    "    modeldata=pd.concat([numericfeatures,catfeatures],axis=1)\n",
    "    from sklearn.preprocessing import MinMaxScaler\n",
    "    from imblearn.over_sampling import SMOTE\n",
    "    scaler = MinMaxScaler()\n",
    "    scaler.fit(modeldata)\n",
    "    features=scaler.transform(modeldata)\n",
    "    import numpy as np\n",
    "    from sklearn.model_selection import train_test_split\n",
    "    X_train, X_test, y_train, y_test = train_test_split(features,model_target)\n",
    "\n",
    "    from sklearn.linear_model import LogisticRegression\n",
    "\n",
    "    from sklearn.model_selection import GridSearchCV\n",
    "\n",
    "    # Setup the hyperparameter grid\n",
    "\n",
    "    c_space = np.logspace(-5, 8, 15)\n",
    "    #c_space = [0.01,0.1,0.05]\n",
    "    param_grid = {'C': [0.1,10,50], 'max_iter': [300,500],'solver':['lbfgs'],'class_weight':['balanced'],'fit_intercept':[True],'intercept_scaling':[1],'penalty':['l2'],}\n",
    "    # Instantiate a logistic regression classifier: logreg\n",
    "\n",
    "    logreg = LogisticRegression()\n",
    "    sm = SMOTE(random_state=2)\n",
    "    X_train_res, y_train_res = sm.fit_sample(X_train, y_train)\n",
    "\n",
    "    # Instantiate the GridSearchCV object: logreg_cv\n",
    "\n",
    "    logreg_cv = GridSearchCV(logreg,param_grid,cv=5)\n",
    "\n",
    "    logfit=logreg_cv.fit(X_train_res,y_train_res)\n",
    "\n",
    "    # Print the tuned parameter and score\n",
    "\n",
    "    #print(\"Tuned Logistic Regression Parameters: {}\".format(logreg_cv.best_params_))\n",
    "\n",
    "    #print(\"Best score is {}\".format(logreg_cv.best_score_))\n",
    "\n",
    "    #Scoring functions\n",
    "    from sklearn import metrics\n",
    "    from sklearn.metrics import accuracy_score\n",
    "    from sklearn.metrics import classification_report\n",
    "    from sklearn.metrics import roc_auc_score\n",
    "    from sklearn.metrics import roc_curve\n",
    "    from sklearn.ensemble import RandomForestClassifier\n",
    "    from sklearn.neighbors import KNeighborsClassifier\n",
    "    pred=logreg_cv.predict(X_test)\n",
    "    logpredictprob_test=logreg_cv.predict_proba(X_test)\n",
    "    Aucscore=roc_auc_score(y_test,pred)\n",
    "    accuracy=logfit.score(X_test,y_test)\n",
    "    modeldict['LogisticregressionAucscore_test']=Aucscore\n",
    "    fpr,tpr, thresholds = roc_curve(y_test,pred)\n",
    "    plotroc(fpr,tpr)\n",
    "    print(pd.crosstab(y_test,pred))\n",
    "    modeldict['Logisticregressionbestparameters']=logreg_cv.best_params_\n",
    "    param_grid = {'max_depth': [3, 5, 6, 7, 8], 'n_estimators':[10,20],'class_weight':['balanced'],'min_samples_split': [3, 5, 6, 7]}\n",
    "    rand_grid = GridSearchCV(RandomForestClassifier(), param_grid, cv=5, refit=True, verbose=0)\n",
    "    #rf.feature_importances_=rand_grid.feature_importances_ \n",
    "    sm = SMOTE(random_state=2)\n",
    "    X_train_res, y_train_res = sm.fit_sample(X_train, y_train)\n",
    "    rand_grid.fit(X_train_res,y_train_res)  \n",
    "    \n",
    "    randpredict=rand_grid.predict(X_test)\n",
    "    randpredict_prob_test=rand_grid.predict_proba(X_test)\n",
    "    modeldict['Randombestparams']=rand_grid.best_params_\n",
    "    randomforestaucscore=roc_auc_score(y_test,randpredict)\n",
    "    modeldict['Randomforestaucscore_test']=randomforestaucscore\n",
    "    from sklearn.metrics import roc_curve, auc\n",
    "    fpr,tpr, thresholds = roc_curve(y_test, randpredict)\n",
    "    plotroc(fpr,tpr)\n",
    "    print(pd.crosstab(y_test, randpredict))\n",
    "    param_grid = {'n_neighbors': [3,5,7,9]}\n",
    "    nb_grid = GridSearchCV(KNeighborsClassifier(), param_grid, cv=5)\n",
    "    sm = SMOTE(random_state=2)\n",
    "    #X_train_res, y_train_res = sm.fit_sample(X_train_res, y_train_res)\n",
    "    nb_grid.fit(X_train_res,y_train_res)\n",
    "    nbpredict=nb_grid.predict(X_test)\n",
    "    modeldict['nbscore_test']=roc_auc_score(y_test,nbpredict)\n",
    "    fpr,tpr, thresholds = roc_curve(y_test, nbpredict)\n",
    "    plotroc(fpr,tpr)\n",
    "    print(pd.crosstab(y_test, nbpredict))\n",
    "    modeldict['nbparams']=nb_grid.best_params_\n",
    "    #print(modeldict)\n",
    "    #finalmodeldata=pd.concat([productdata,pd.DataFrame(randpredict)],axis=1)\n",
    "    return(modeldict,pred,randpredict,nbpredict,randpredict_prob_test, logpredictprob_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "\"['Bookingamount'] not in index\"",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-38-62116e11ab27>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mbuildmodel\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmergeddata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[0;32m<ipython-input-37-cb69358773dd>\u001b[0m in \u001b[0;36mbuildmodel\u001b[0;34m(dataframe)\u001b[0m\n\u001b[1;32m      4\u001b[0m     \u001b[0mproductdata\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mdataframe\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m     \u001b[0mproductdata\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 6\u001b[0;31m     \u001b[0mnumericfeatures\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mproductdata\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'Bookingamount'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m'Invoiceamount'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m'dayssincelasttransaction'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m'BonusTrans'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'QualMiles'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'Bonusmiles'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'FlightMiles'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m'age'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m'DaysSinceEnroll'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      7\u001b[0m     \u001b[0mcatfeatures\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mproductdata\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'geog'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m'gender'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      8\u001b[0m     \u001b[0mmodel_target\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mproductdata\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"target\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvalues\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/.local/lib/python3.7/site-packages/pandas/core/frame.py\u001b[0m in \u001b[0;36m__getitem__\u001b[0;34m(self, key)\u001b[0m\n\u001b[1;32m   2932\u001b[0m                 \u001b[0mkey\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mlist\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2933\u001b[0m             indexer = self.loc._convert_to_indexer(key, axis=1,\n\u001b[0;32m-> 2934\u001b[0;31m                                                    raise_missing=True)\n\u001b[0m\u001b[1;32m   2935\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2936\u001b[0m         \u001b[0;31m# take() does not accept boolean indexers\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/.local/lib/python3.7/site-packages/pandas/core/indexing.py\u001b[0m in \u001b[0;36m_convert_to_indexer\u001b[0;34m(self, obj, axis, is_setter, raise_missing)\u001b[0m\n\u001b[1;32m   1352\u001b[0m                 kwargs = {'raise_missing': True if is_setter else\n\u001b[1;32m   1353\u001b[0m                           raise_missing}\n\u001b[0;32m-> 1354\u001b[0;31m                 \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_listlike_indexer\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mobj\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1355\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1356\u001b[0m             \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/.local/lib/python3.7/site-packages/pandas/core/indexing.py\u001b[0m in \u001b[0;36m_get_listlike_indexer\u001b[0;34m(self, key, axis, raise_missing)\u001b[0m\n\u001b[1;32m   1159\u001b[0m         self._validate_read_indexer(keyarr, indexer,\n\u001b[1;32m   1160\u001b[0m                                     \u001b[0mo\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_axis_number\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0maxis\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1161\u001b[0;31m                                     raise_missing=raise_missing)\n\u001b[0m\u001b[1;32m   1162\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mkeyarr\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mindexer\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1163\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/.local/lib/python3.7/site-packages/pandas/core/indexing.py\u001b[0m in \u001b[0;36m_validate_read_indexer\u001b[0;34m(self, key, indexer, axis, raise_missing)\u001b[0m\n\u001b[1;32m   1250\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mname\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;34m'loc'\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mraise_missing\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1251\u001b[0m                 \u001b[0mnot_found\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mlist\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mset\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m-\u001b[0m \u001b[0mset\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0max\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1252\u001b[0;31m                 \u001b[0;32mraise\u001b[0m \u001b[0mKeyError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"{} not in index\"\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mformat\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mnot_found\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1253\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1254\u001b[0m             \u001b[0;31m# we skip the warning on Categorical/Interval\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mKeyError\u001b[0m: \"['Bookingamount'] not in index\""
     ]
    }
   ],
   "source": [
    "buildmodel(mergeddata)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "!pip install imblearn"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Final model building from selected parameters\n",
    "from sklearn.ensemble import RandomForestClassifier\n",
    "rf=RandomForestClassifier(class_weight='balanced',max_depth=3,min_samples_split=3,n_estimators=10)\n",
    "numericfeatures=mergeddata[['Bookingamount','Invoiceamount','dayssincelasttransaction','BonusTrans', 'QualMiles', 'Bonusmiles', 'FlightMiles','age','DaysSinceEnroll'] ]\n",
    "catfeatures=mergeddata[['geog','gender']]\n",
    "model_target=mergeddata[\"target\"].values\n",
    "catfeatures=pd.get_dummies(catfeatures)\n",
    "modeldata=pd.concat([numericfeatures,catfeatures],axis=1)\n",
    "from sklearn.preprocessing import MinMaxScaler\n",
    "from imblearn.over_sampling import SMOTE\n",
    "scaler = MinMaxScaler()\n",
    "scaler=scaler.fit(modeldata)\n",
    "features=scaler.transform(modeldata)\n",
    "rf.fit(features,model_target)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Generate final predictions\n",
    "from sklearn.metrics import roc_auc_score\n",
    "from sklearn.metrics import roc_curve\n",
    "predictfinal=rf.predict(features)\n",
    "fpr,tpr, thresholds = roc_curve(model_target,predictfinal)\n",
    "plotroc(fpr,tpr)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "importances=rf.feature_importances_\n",
    "    #Plot the feature importances in predicting the target variables\n",
    "importances\n",
    "max_imp=np.max(importances)\n",
    "min_imp=np.min(importances)\n",
    "indices = np.argsort(importances)[::-1]\n",
    "plt.figure()\n",
    "plt.title(\"Feature importances\")\n",
    "plt.bar(range(0,10),importances[:10],color=\"r\", align=\"center\")\n",
    "plt.xticks(range(0,10), modeldata.columns[indices[:10]], rotation=45, ha='right')\n",
    " "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
